let participants=[];async function initApp(){try{let e=await fetch("users_encrypted.json");if(!e.ok){alert("Error: No se pudo cargar el archivo.");return}let t=await e.text(),n=atob(t);if(!(participants=JSON.parse(n))||0===participants.length){alert("Error: No se pudieron cargar los datos del sorteo.");return}renderGameGrid()}catch(r){console.error(r),alert("Error al leer.")}}function renderGameGrid(){let e=document.getElementById("user-grid");e.innerHTML="",participants.forEach(t=>{let n=document.createElement("div");n.className="user-card",n.innerText=t.name,n.onclick=()=>selectUser(t),e.appendChild(n)})}function selectUser(e){selectedUser=e,document.getElementById("game-view").classList.add("hidden"),document.getElementById("reveal-view").classList.remove("hidden"),document.getElementById("reveal-title").innerText=`Hola, ${e.name}`,document.getElementById("authPin").value="",document.getElementById("secret-result").classList.add("hidden")}function checkPin(){let e=document.getElementById("authPin").value;if(e===selectedUser.pin){let t=participants.find(e=>e.id===selectedUser.matchId);document.getElementById("result-name").innerText=t.name,document.getElementById("secret-result").classList.remove("hidden")}else document.getElementById("secret-result").classList.add("hidden"),alert("PIN Incorrecto. Int\xe9ntalo de nuevo."),document.getElementById("authPin").value=""}function backToGame(){selectedUser=null,document.getElementById("reveal-view").classList.add("hidden"),document.getElementById("game-view").classList.remove("hidden")}window.onload=initApp;